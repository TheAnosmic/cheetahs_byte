from compile import build_to_bytecode
from compile.runner import run
from compile.vm import RunnerVM
from compile import ALLOWED_OPCODES
from compile import compile_from_string

if '__main__' == __name__:
    opcodes = ALLOWED_OPCODES['HARDEST']
    s = r"""
__/\\\\\\\\\\\\\\\__/\\\______________________________________/\\\\\\\\\_____________________________________________________________________________________
 _\///////\\\/////__\/\\\____________________________________/\\\\\\\\\\\\\___________________________________________________________________________________
  _______\/\\\_______\/\\\___________________________________/\\\/////////\\\_______________________________________________________________/\\\_______________
   _______\/\\\_______\/\\\_____________/\\\\\\\\____________\/\\\_______\/\\\__/\\/\\\\\\_______/\\\\\_____/\\\\\\\\\\____/\\\\\__/\\\\\___\///______/\\\\\\\\_
    _______\/\\\_______\/\\\\\\\\\\____/\\\/////\\\___________\/\\\\\\\\\\\\\\\_\/\\\////\\\____/\\\///\\\__\/\\\//////___/\\\///\\\\\///\\\__/\\\___/\\\//////__
     _______\/\\\_______\/\\\/////\\\__/\\\\\\\\\\\____________\/\\\/////////\\\_\/\\\__\//\\\__/\\\__\//\\\_\/\\\\\\\\\\_\/\\\_\//\\\__\/\\\_\/\\\__/\\\_________
      _______\/\\\_______\/\\\___\/\\\_\//\\///////_____________\/\\\_______\/\\\_\/\\\___\/\\\_\//\\\__/\\\__\////////\\\_\/\\\__\/\\\__\/\\\_\/\\\_\//\\\________
       _______\/\\\_______\/\\\___\/\\\__\//\\\\\\\\\\___________\/\\\_______\/\\\_\/\\\___\/\\\__\///\\\\\/____/\\\\\\\\\\_\/\\\__\/\\\__\/\\\_\/\\\__\///\\\\\\\\_
        _______\///________\///____\///____\//////////____________\///________\///__\///____\///_____\/////_____\//////////__\///___\///___\///__\///_____\////////__
        """
    node_chain = compile_from_string(s, allowed_opcodes=opcodes)
    bytecode = build_to_bytecode(node_chain)
    vm = RunnerVM(bytecode)
    run(bytecode, vm)
    from compile.disassembler import disassemble

    print '\n'.join(disassemble(node_chain))
    print ' '.join(str(t) for t in vm.opcode_used)
    print vm.out